local LoadingTime = tick();

local Players, SGui = game:GetService"Players", game:GetService"StarterGui";
local CyAdminUserTable, DrPoppaUserTable, CitizenUserTable, ZetoxUserTable = {}, {}, {}, {};

function Notify(T1, T2, T3, T4)
    if SGui then 
        SGui:SetCore("SendNotification", {
            Title = T1;
            Text = T2;
            Icon = T3;
            Duration = T4;
        }) 
    end
end

function CheckPlayer(v)
    if v then 
        v.Chatted:Connect(function(Msg)
            local CyAdminString, CyAdminString2 = "Hey I'm a cyrus' streets admin user1", "I am a CyAdmin User";
            local ZetoxString, ZetoxString2 = "[ZETOX OVERLORD XAXA] WELCOME TO ZETOX V8", "[Oskar]";
            local DrPoppaString, CitizenString = "D|U", "Citizen Man";
            
            --rconsolename("script detector/logger v1 - by xaxa")
            
            if string.sub(Msg, 1, string.len(CyAdminString)) == CyAdminString or string.sub(Msg, 1, string.len(CyAdminString2)) == CyAdminString2 then 
                table.insert(CyAdminUserTable, v)
                warn(""..tostring(v).." is using CyAdmin\n")
                
            elseif string.sub(Msg, 1, string.len(DrPoppaString)) == DrPoppaString then 
                table.insert(DrPoppaUserTable, v)
                warn(""..tostring(v).." is using DrPoppa\n")
            elseif string.sub(Msg, 1, string.len(CitizenString)) == CitizenString then 
                table.insert(CitizenUserTable, v)
                warn(""..tostring(v).." is using Citizen\n")
                
            elseif string.sub(Msg, 1, string.len(ZetoxString)) == ZetoxString or string.sub(Msg, 1, string.len(ZetoxString2)) == ZetoxString2 then 
                table.insert(ZetoxUserTable, v)
                warn(""..tostring(v).." is using Zetox\n")
            end
            
        end)
    end
end

for _, v in next, Players:GetPlayers() do 
    CheckPlayer(v)
end
Players.PlayerAdded:Connect(CheckPlayer)

spawn(function()
    Notify("xaxa", "Script Logger v1.1, loaded in: "..string.format("%.7f", tostring(tick() - LoadingTime)), "", 2)
    wait(2)
    Notify("xaxa", "Press F9 to see people who are found to be using scripts!", "", 3)
end)
